<!-- index.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#0b1220" />

  <!-- iOS PWA -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="City Flip">
  <link rel="apple-touch-icon" href="./icons/icon-192.png">

  <!-- PWA -->
  <link rel="manifest" href="./manifest.webmanifest">
  <link rel="icon" href="./icons/icon-192.png">

  <title>City Flip</title>
  <link rel="stylesheet" href="./styles.css" />

  <!-- OPTIONAL: Google AdSense Auto Ads (uncomment + set your client) -->
  <!--
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXX"
    crossorigin="anonymous"></script>
  -->
</head>

<body>
  <div id="app">
    <header class="topbar">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div class="titles">
          <div class="name">City Flip</div>
          <div class="tagline" id="tagline">Merge buildings. Grow a skyline. Beat your best.</div>
        </div>
      </div>

      <div class="top-actions">
        <button id="btnSound" class="chip" aria-label="Toggle sound">
          <span class="dot" aria-hidden="true"></span><span id="soundLabel">Sound: On</span>
        </button>
        <button id="btnHelp" class="chip" aria-label="How to play">How to Play</button>
      </div>
    </header>

    <main class="stage">
      <!-- Animated background -->
      <canvas id="bgCanvas" aria-hidden="true"></canvas>

      <!-- HUD -->
      <section class="hud" aria-label="Game status">
        <div class="stat">
          <div class="statLabel">Score</div>
          <div class="statValue" id="score">0</div>
        </div>
        <div class="stat">
          <div class="statLabel">Coins</div>
          <div class="statValue" id="coins">0</div>
        </div>
        <div class="stat">
          <div class="statLabel">Streak</div>
          <div class="statValue" id="streak">x1</div>
        </div>
      </section>

      <!-- Next tile + Mission -->
      <section class="panel">
        <div class="nextWrap">
          <div class="nextTitle">Next Building</div>
          <div class="nextCard" id="nextCard" role="img" aria-label="Next building preview">
            <div class="nextGlyph" id="nextGlyph"></div>
            <div class="nextInfo">
              <div class="nextName" id="nextName">Block</div>
              <div class="nextHint">Tap an empty spot to place it.</div>
            </div>
          </div>
        </div>

        <div class="missionWrap">
          <div class="nextTitle">Mission</div>
          <div class="missionCard">
            <div class="missionText" id="missionText">Make your first merge.</div>
            <div class="missionProg">
              <div class="bar"><div class="barFill" id="missionFill"></div></div>
              <div class="missionMeta"><span id="missionNow">0</span>/<span id="missionGoal">1</span></div>
            </div>
          </div>
        </div>
      </section>

      <!-- Grid -->
      <section class="boardWrap" aria-label="City grid">
        <div id="board" class="board" role="grid" aria-label="4 by 4 grid"></div>
      </section>

      <!-- Bottom buttons -->
      <footer class="bottombar">
        <button id="btnUndo" class="btn secondary" disabled>Undo</button>
        <button id="btnBoost" class="btn secondary">Boost</button>
        <button id="btnNew" class="btn primary">New Run</button>
      </footer>

      <!-- Toast -->
      <div id="toast" class="toast" role="status" aria-live="polite"></div>

      <!-- Tutorial / Help Modal -->
      <div id="modal" class="modal" aria-hidden="true">
        <div class="modalCard" role="dialog" aria-modal="true" aria-label="How to play">
          <div class="modalHead">
            <div class="modalTitle">How to Play</div>
            <button id="btnCloseModal" class="x" aria-label="Close">✕</button>
          </div>

          <div class="modalBody">
            <div class="howRow">
              <div class="howNum">1</div>
              <div>
                <div class="howTitle">Place the “Next Building”</div>
                <div class="howText">Tap an empty tile. Your goal is to build the most valuable skyline.</div>
              </div>
            </div>

            <div class="howRow">
              <div class="howNum">2</div>
              <div>
                <div class="howTitle">Merge 3+ touching matches</div>
                <div class="howText">When <b>3 or more</b> of the same building touch (orthogonal), they merge into the next tier and give coins + score.</div>
              </div>
            </div>

            <div class="howRow">
              <div class="howNum">3</div>
              <div>
                <div class="howTitle">Chain reactions = streaks</div>
                <div class="howText">Bigger chains build your streak multiplier. Keep the board open and plan merges.</div>
              </div>
            </div>

            <div class="howRow">
              <div class="howNum">★</div>
              <div>
                <div class="howTitle">Boost</div>
                <div class="howText">Spend coins to “reroll” your next building. Great when you’re stuck.</div>
              </div>
            </div>

            <div class="ctaRow">
              <button id="btnPlay" class="btn primary big">Play</button>
            </div>
          </div>
        </div>
      </div>

      <!-- First-load purpose overlay (crystal clear) -->
      <div id="firstLoad" class="firstLoad" aria-hidden="true">
        <div class="firstCard">
          <div class="firstKicker">Build an addictive skyline in 30 seconds</div>
          <div class="firstTitle">Tap to place. Merge 3+ to upgrade.</div>
          <div class="firstSub">
            Chain merges to raise your streak, earn coins, and chase a new high score.
          </div>
          <div class="firstActions">
            <button id="btnStartNow" class="btn primary big">Start a Run</button>
            <button id="btnLearn" class="btn secondary big">How it Works</button>
          </div>
          <div class="fine">Tip: Turn sound on — merges feel better.</div>
        </div>
      </div>
    </main>
  </div>

  <script src="./game.js" defer></script>
</body>
</html>
